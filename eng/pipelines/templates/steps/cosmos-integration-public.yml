parameters:
  EmulatorMsiUrl: "https://aka.ms/cosmosdb-emulator"

steps:
  - powershell: |
      Write-Host "Downloading and extracting Cosmos DB Emulator - ${{ parameters.EmulatorMsiUrl }}"
      &msiexec /a ${{ parameters.EmulatorMsiUrl }} TARGETDIR=$env:temp /qn | wait-process
    displayName: Download and Extract Public Cosmos DB Emulator

  - powershell: |
      Write-Host "Launching Cosmos DB Emulator"
      Import-Module Import-Module "$env:Temp\Azure Cosmos DB Emulator\SourceDir\Azure Cosmos DB Emulator\PSModules\Microsoft.Azure.CosmosDB.Emulator"
      Start-CosmosDbEmulator
    displayName: Start Cosmos DB Emulator
