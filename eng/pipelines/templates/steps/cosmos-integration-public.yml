parameters:
  EmulatorMsiUrl: "https://aka.ms/cosmosdb-emulator"

steps:
  - pwsh: |
      $targetDir = $env:temp
      Write-Host "Downloading and extracting Cosmos DB Emulator - ${{ parameters.EmulatorMsiUrl }}"
      Write-Host "Target Dir: $targetDir"
      msiexec /a ${{ parameters.EmulatorMsiUrl }} TARGETDIR=$targetDir /qn | wait-process
    displayName: Download and Extract Public Cosmos DB Emulator

  - pwsh: |
      Write-Host "Launching Cosmos DB Emulator"
      Start-Process "$env:tmp\Azure Cosmos DB Emulator\CosmosDB.Emulator.exe" "/NoExplorer /NoUI" -Verb RunAs
    displayName: Start Cosmos DB Emulator
