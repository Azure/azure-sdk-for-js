trigger: none
pr: none

# This pipeline is used to create PR automatically for rush update by running rush update --recheck

jobs:
  - job: 'ValidateDependencies'
    variables:
      - template: /eng/pipelines/templates/variables/globals.yml

    pool:
      name: azsdk-pool-mms-ubuntu-1804-general
      vmImage: MMSUbuntu18.04

    steps:
    - template: /eng/pipelines/templates/steps/common.yml

    - script: |
        node common/scripts/install-run-rush.js install
        rush update --recheck
      displayName: "Run Rush Update"

    - template: /eng/common/pipelines/templates/steps/create-pull-request.yml
      condition: succeeded()
      parameters:
        RepoName: azure-sdk-for-js
        PRBranchName: automated-rush-update-$(Build.BuildId)
        CommitMsg: "Automatic rush update recheck"
        PRTitle: "Automatic rush update"
