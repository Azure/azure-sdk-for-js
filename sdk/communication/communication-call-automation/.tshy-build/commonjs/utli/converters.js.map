{"version":3,"file":"converters.js","sourceRoot":"","sources":["../../../src/utli/converters.ts"],"names":[],"mappings":";AAAA,uCAAuC;AACvC,kCAAkC;;AAmDlC,kFAUC;AAGD,wEAcC;AAGD,4EAyDC;AAGD,sFA8CC;AAGD,4DAUC;AAGD,8FAQC;AAGD,oFAQC;AAGD,8FAQC;AAGD,oFAQC;AAxOD,sEAOqC;AAUrC,wDAAkF;AAGlF,SAAS,WAAW,CAClB,eAA6C;IAE7C,IAAI,eAAe,CAAC,iBAAiB,KAAK,SAAS,EAAE,CAAC;QACpD,OAAO,gDAAqC,CAAC,iBAAiB,CAAC;IACjE,CAAC;IACD,IAAI,eAAe,CAAC,WAAW,KAAK,SAAS,EAAE,CAAC;QAC9C,OAAO,gDAAqC,CAAC,WAAW,CAAC;IAC3D,CAAC;IACD,IAAI,eAAe,CAAC,kBAAkB,KAAK,SAAS,EAAE,CAAC;QACrD,OAAO,gDAAqC,CAAC,kBAAkB,CAAC;IAClE,CAAC;IACD,IAAI,eAAe,CAAC,iBAAiB,KAAK,SAAS,EAAE,CAAC;QACpD,OAAO,gDAAqC,CAAC,iBAAiB,CAAC;IACjE,CAAC;IACD,OAAO,gDAAqC,CAAC,OAAO,CAAC;AACvD,CAAC;AAED,wFAAwF;AACxF,SAAgB,mCAAmC,CACjD,qBAAwD;IAExD,IAAI,qBAAqB,KAAK,SAAS,IAAI,qBAAqB,CAAC,WAAW,KAAK,SAAS,EAAE,CAAC;QAC3F,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,MAAM,0BAA0B,GAC9B,IAAA,uDAAgC,EAAC,qBAAqB,CAAC,CAAC,WAAW,CAAC;IACtE,OAAO,0BAA0B,CAAC;AACpC,CAAC;AAED,2FAA2F;AAC3F,SAAgB,8BAA8B,CAC5C,+BAA4E;IAE5E,IACE,+BAA+B,KAAK,SAAS;QAC7C,CAAA,+BAA+B,aAA/B,+BAA+B,uBAA/B,+BAA+B,CAAE,KAAK,MAAK,IAAI,EAC/C,CAAC;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,MAAM,qBAAqB,GAA0B;QACnD,WAAW,EAAE,+BAA+B,CAAC,KAAK;KACnD,CAAC;IACF,OAAO,qBAAqB,CAAC;AAC/B,CAAC;AAED,0FAA0F;AAC1F,SAAgB,gCAAgC,CAC9C,eAA6C;IAE7C,MAAM,KAAK,GAAG,eAAe,CAAC,KAAK,CAAC;IACpC,MAAM,IAAI,GACR,eAAe,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC;IAE3F,IACE,IAAI,KAAK,gDAAqC,CAAC,iBAAiB;QAChE,eAAe,CAAC,iBAAiB,KAAK,SAAS,EAC/C,CAAC;QACD,MAAM,2BAA2B,GAAgC;YAC/D,mBAAmB,EAAE,eAAe,CAAC,iBAAiB,CAAC,EAAE;SAC1D,CAAC;QACF,OAAO,2BAA2B,CAAC;IACrC,CAAC;IAED,IACE,IAAI,KAAK,gDAAqC,CAAC,WAAW;QAC1D,eAAe,CAAC,WAAW,KAAK,SAAS,EACzC,CAAC;QACD,MAAM,qBAAqB,GAA0B;YACnD,WAAW,EAAE,eAAe,CAAC,WAAW,CAAC,KAAK;YAC9C,KAAK,EAAE,KAAK;SACb,CAAC;QACF,OAAO,qBAAqB,CAAC;IAC/B,CAAC;IAED,IACE,IAAI,KAAK,gDAAqC,CAAC,kBAAkB;QACjE,eAAe,CAAC,kBAAkB,KAAK,SAAS,EAChD,CAAC;QACD,MAAM,4BAA4B,GAAiC;YACjE,KAAK,EAAE,KAAK;YACZ,oBAAoB,EAAE,eAAe,CAAC,kBAAkB,CAAC,MAAM;YAC/D,WAAW,EAAE,eAAe,CAAC,kBAAkB,CAAC,WAAW;YAC3D,KAAK,EAAE,eAAe,CAAC,kBAAkB,CAAC,KAAgD;SAC3F,CAAC;QACF,OAAO,4BAA4B,CAAC;IACtC,CAAC;IAED,IACE,IAAI,KAAK,gDAAqC,CAAC,iBAAiB;QAChE,eAAe,CAAC,iBAAiB,KAAK,SAAS,EAC/C,CAAC;QACD,MAAM,2BAA2B,GAAgC;YAC/D,KAAK,EAAE,KAAK;YACZ,UAAU,EAAE,eAAe,CAAC,iBAAiB,CAAC,KAAK;YACnD,KAAK,EAAE,eAAe,CAAC,iBAAiB,CAAC,KAAgD;SAC1F,CAAC;QACF,OAAO,2BAA2B,CAAC;IACrC,CAAC;IAED,MAAM,iBAAiB,GAAsB;QAC3C,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;KACvB,CAAC;IACF,OAAO,iBAAiB,CAAC;AAC3B,CAAC;AAED,4FAA4F;AAC5F,SAAgB,qCAAqC,CACnD,UAAmC;IAEnC,MAAM,oBAAoB,GACxB,IAAA,uDAAgC,EAAC,UAAU,CAAC,CAAC;IAC/C,IAAI,IAAA,oDAA6B,EAAC,UAAU,CAAC,EAAE,CAAC;QAC9C,MAAM,gCAAgC,mBACpC,IAAI,EAAE,gDAAqC,CAAC,iBAAiB,IAC1D,oBAAoB,CACxB,CAAC;QACF,OAAO,gCAAgC,CAAC;IAC1C,CAAC;IAED,IAAI,IAAA,8CAAuB,EAAC,UAAU,CAAC,EAAE,CAAC;QACxC,MAAM,0BAA0B,mBAC9B,IAAI,EAAE,gDAAqC,CAAC,WAAW,IACpD,oBAAoB,CACxB,CAAC;QACF,OAAO,0BAA0B,CAAC;IACpC,CAAC;IAED,IAAI,IAAA,qDAA8B,EAAC,UAAU,CAAC,EAAE,CAAC;QAC/C,MAAM,iCAAiC,mBACrC,IAAI,EAAE,gDAAqC,CAAC,kBAAkB,IAC3D,oBAAoB,CACxB,CAAC;QACF,OAAO,iCAAiC,CAAC;IAC3C,CAAC;IAED,IAAI,IAAA,oDAA6B,EAAC,UAAU,CAAC,EAAE,CAAC;QAC9C,MAAM,gCAAgC,mBACpC,IAAI,EAAE,gDAAqC,CAAC,iBAAiB,IAC1D,oBAAoB,CACxB,CAAC;QACF,OAAO,gCAAgC,CAAC;IAC1C,CAAC;IAED,IAAI,IAAA,0CAAmB,EAAC,UAAU,CAAC,EAAE,CAAC;QACpC,MAAM,sBAAsB,mBAC1B,IAAI,EAAE,gDAAqC,CAAC,OAAO,IAChD,oBAAoB,CACxB,CAAC;QACF,OAAO,sBAAsB,CAAC;IAChC,CAAC;IAED,MAAM,IAAI,KAAK,EAAE,CAAC;AACpB,CAAC;AAED,yDAAyD;AACzD,SAAgB,wBAAwB,CACtC,kBAA2C;IAE3C,MAAM,eAAe,mCAChB,kBAAkB,KACrB,UAAU,EAAE,kBAAkB,CAAC,UAAU;YACvC,CAAC,CAAC,gCAAgC,CAAC,kBAAkB,CAAC,UAAU,CAAC;YACjE,CAAC,CAAC,SAAS,GACd,CAAC;IACF,OAAO,eAAe,CAAC;AACzB,CAAC;AAED,qGAAqG;AACrG,SAAgB,yCAAyC,CACvD,UAAmD;IAEnD,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,CAAC,mBAAmB,EAAE,CAAC;QACnD,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,OAAO,EAAE,EAAE,EAAE,UAAU,CAAC,mBAAmB,EAAE,CAAC;AAChD,CAAC;AAED,mGAAmG;AACnG,SAAgB,oCAAoC,CAClD,UAAwD;IAExD,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,CAAC;QAClC,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,OAAO,EAAE,mBAAmB,EAAE,UAAU,CAAC,EAAE,EAAE,CAAC;AAChD,CAAC;AAED,qGAAqG;AACrG,SAAgB,yCAAyC,CACvD,UAAmD;IAEnD,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC;QAC1C,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,OAAO,EAAE,KAAK,EAAE,UAAU,CAAC,UAAU,EAAE,CAAC;AAC1C,CAAC;AAED,mGAAmG;AACnG,SAAgB,oCAAoC,CAClD,UAAwD;IAExD,IAAI,CAAC,UAAU,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;QACrC,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,OAAO,EAAE,UAAU,EAAE,UAAU,CAAC,KAAK,EAAE,CAAC;AAC1C,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport type {\n  PhoneNumberIdentifier,\n  CommunicationUserIdentifier,\n  UnknownIdentifier,\n  SerializedPhoneNumberIdentifier,\n  CommunicationIdentifier,\n  SerializedCommunicationIdentifier,\n  MicrosoftTeamsUserIdentifier,\n  MicrosoftTeamsAppIdentifier,\n} from \"@azure/communication-common\";\nimport {\n  serializeCommunicationIdentifier,\n  isCommunicationUserIdentifier,\n  isPhoneNumberIdentifier,\n  isUnknownIdentifier,\n  isMicrosoftTeamsUserIdentifier,\n  isMicrosoftTeamsAppIdentifier,\n} from \"@azure/communication-common\";\nimport type {\n  CallParticipantInternal,\n  CommunicationIdentifierModel,\n  CommunicationIdentifierModelKind,\n  KnownCommunicationCloudEnvironmentModel,\n  PhoneNumberIdentifierModel,\n  CommunicationUserIdentifierModel,\n  MicrosoftTeamsAppIdentifierModel,\n} from \"../generated/src/index.js\";\nimport { KnownCommunicationIdentifierModelKind } from \"../generated/src/index.js\";\nimport type { CallParticipant } from \"../models/models.js\";\n\nfunction extractKind(\n  identifierModel: CommunicationIdentifierModel,\n): CommunicationIdentifierModelKind {\n  if (identifierModel.communicationUser !== undefined) {\n    return KnownCommunicationIdentifierModelKind.CommunicationUser;\n  }\n  if (identifierModel.phoneNumber !== undefined) {\n    return KnownCommunicationIdentifierModelKind.PhoneNumber;\n  }\n  if (identifierModel.microsoftTeamsUser !== undefined) {\n    return KnownCommunicationIdentifierModelKind.MicrosoftTeamsUser;\n  }\n  if (identifierModel.microsoftTeamsApp !== undefined) {\n    return KnownCommunicationIdentifierModelKind.MicrosoftTeamsApp;\n  }\n  return KnownCommunicationIdentifierModelKind.Unknown;\n}\n\n/** Convert PhoneNumberIdentifier to PhoneNumberIdentifierModel(Internal usage class) */\nexport function PhoneNumberIdentifierModelConverter(\n  phoneNumberIdentifier: PhoneNumberIdentifier | undefined,\n): PhoneNumberIdentifierModel | undefined {\n  if (phoneNumberIdentifier === undefined || phoneNumberIdentifier.phoneNumber === undefined) {\n    return undefined;\n  }\n\n  const phoneNumberIdentifierModel =\n    serializeCommunicationIdentifier(phoneNumberIdentifier).phoneNumber;\n  return phoneNumberIdentifierModel;\n}\n\n/** Convert SerializedPhoneNumberIdentifier to PhoneNumberIdentifier(Public usage class) */\nexport function phoneNumberIdentifierConverter(\n  serializedPhoneNumberIdentifier: SerializedPhoneNumberIdentifier | undefined,\n): PhoneNumberIdentifier | undefined {\n  if (\n    serializedPhoneNumberIdentifier === undefined ||\n    serializedPhoneNumberIdentifier?.value === null\n  ) {\n    return undefined;\n  }\n\n  const phoneNumberIdentifier: PhoneNumberIdentifier = {\n    phoneNumber: serializedPhoneNumberIdentifier.value,\n  };\n  return phoneNumberIdentifier;\n}\n\n/** Convert CommunicationIdentifierModel to CommunicationIdentifier(Public usage class) */\nexport function communicationIdentifierConverter(\n  identifierModel: CommunicationIdentifierModel,\n): CommunicationIdentifier {\n  const rawId = identifierModel.rawId;\n  const kind =\n    identifierModel.kind !== undefined ? identifierModel.kind : extractKind(identifierModel);\n\n  if (\n    kind === KnownCommunicationIdentifierModelKind.CommunicationUser &&\n    identifierModel.communicationUser !== undefined\n  ) {\n    const communicationUserIdentifier: CommunicationUserIdentifier = {\n      communicationUserId: identifierModel.communicationUser.id,\n    };\n    return communicationUserIdentifier;\n  }\n\n  if (\n    kind === KnownCommunicationIdentifierModelKind.PhoneNumber &&\n    identifierModel.phoneNumber !== undefined\n  ) {\n    const phoneNumberIdentifier: PhoneNumberIdentifier = {\n      phoneNumber: identifierModel.phoneNumber.value,\n      rawId: rawId,\n    };\n    return phoneNumberIdentifier;\n  }\n\n  if (\n    kind === KnownCommunicationIdentifierModelKind.MicrosoftTeamsUser &&\n    identifierModel.microsoftTeamsUser !== undefined\n  ) {\n    const microsoftTeamsUserIdentifier: MicrosoftTeamsUserIdentifier = {\n      rawId: rawId,\n      microsoftTeamsUserId: identifierModel.microsoftTeamsUser.userId,\n      isAnonymous: identifierModel.microsoftTeamsUser.isAnonymous,\n      cloud: identifierModel.microsoftTeamsUser.cloud as KnownCommunicationCloudEnvironmentModel,\n    };\n    return microsoftTeamsUserIdentifier;\n  }\n\n  if (\n    kind === KnownCommunicationIdentifierModelKind.MicrosoftTeamsApp &&\n    identifierModel.microsoftTeamsApp !== undefined\n  ) {\n    const microsoftTeamsAppIdentifier: MicrosoftTeamsAppIdentifier = {\n      rawId: rawId,\n      teamsAppId: identifierModel.microsoftTeamsApp.appId,\n      cloud: identifierModel.microsoftTeamsApp.cloud as KnownCommunicationCloudEnvironmentModel,\n    };\n    return microsoftTeamsAppIdentifier;\n  }\n\n  const unknownIdentifier: UnknownIdentifier = {\n    id: rawId ? rawId : \"\",\n  };\n  return unknownIdentifier;\n}\n\n/** Convert CommunicationIdentifier to CommunicationIdentifierModel(Internal usage class) */\nexport function communicationIdentifierModelConverter(\n  identifier: CommunicationIdentifier,\n): CommunicationIdentifierModel {\n  const serializedIdentifier: SerializedCommunicationIdentifier =\n    serializeCommunicationIdentifier(identifier);\n  if (isCommunicationUserIdentifier(identifier)) {\n    const communicationUserIdentifierModel: CommunicationIdentifierModel = {\n      kind: KnownCommunicationIdentifierModelKind.CommunicationUser,\n      ...serializedIdentifier,\n    };\n    return communicationUserIdentifierModel;\n  }\n\n  if (isPhoneNumberIdentifier(identifier)) {\n    const phoneNumberIdentifierModel: CommunicationIdentifierModel = {\n      kind: KnownCommunicationIdentifierModelKind.PhoneNumber,\n      ...serializedIdentifier,\n    };\n    return phoneNumberIdentifierModel;\n  }\n\n  if (isMicrosoftTeamsUserIdentifier(identifier)) {\n    const microsoftTeamsUserIdentifierModel: CommunicationIdentifierModel = {\n      kind: KnownCommunicationIdentifierModelKind.MicrosoftTeamsUser,\n      ...serializedIdentifier,\n    };\n    return microsoftTeamsUserIdentifierModel;\n  }\n\n  if (isMicrosoftTeamsAppIdentifier(identifier)) {\n    const microsoftTeamsAppIdentifierModel: CommunicationIdentifierModel = {\n      kind: KnownCommunicationIdentifierModelKind.MicrosoftTeamsApp,\n      ...serializedIdentifier,\n    };\n    return microsoftTeamsAppIdentifierModel;\n  }\n\n  if (isUnknownIdentifier(identifier)) {\n    const unknownIdentifierModel: CommunicationIdentifierModel = {\n      kind: KnownCommunicationIdentifierModelKind.Unknown,\n      ...serializedIdentifier,\n    };\n    return unknownIdentifierModel;\n  }\n\n  throw new Error();\n}\n\n/** Convert CallParticipantInternal to CallParticipant */\nexport function callParticipantConverter(\n  acsCallParticipant: CallParticipantInternal,\n): CallParticipant {\n  const callParticipant: CallParticipant = {\n    ...acsCallParticipant,\n    identifier: acsCallParticipant.identifier\n      ? communicationIdentifierConverter(acsCallParticipant.identifier)\n      : undefined,\n  };\n  return callParticipant;\n}\n\n/** Convert CommunicationUserIdentifier to CommunicationUserIdentifierModel (Internal usage class) */\nexport function communicationUserIdentifierModelConverter(\n  identifier: CommunicationUserIdentifier | undefined,\n): CommunicationUserIdentifierModel | undefined {\n  if (!identifier || !identifier.communicationUserId) {\n    return undefined;\n  }\n\n  return { id: identifier.communicationUserId };\n}\n\n/** Convert CommunicationUserIdentifierModel to CommunicationUserIdentifier (Public usage class) */\nexport function communicationUserIdentifierConverter(\n  identifier: CommunicationUserIdentifierModel | undefined,\n): CommunicationUserIdentifier | undefined {\n  if (!identifier || !identifier.id) {\n    return undefined;\n  }\n\n  return { communicationUserId: identifier.id };\n}\n\n/** Convert MicrosoftTeamsAppIdentifier to MicrosoftTeamsAppIdentifierModel (Internal usage class) */\nexport function microsoftTeamsAppIdentifierModelConverter(\n  identifier: MicrosoftTeamsAppIdentifier | undefined,\n): MicrosoftTeamsAppIdentifierModel | undefined {\n  if (!identifier || !identifier.teamsAppId) {\n    return undefined;\n  }\n\n  return { appId: identifier.teamsAppId };\n}\n\n/** Convert MicrosoftTeamsAppIdentifierModel to MicrosoftTeamsAppIdentifier (Public usage class) */\nexport function microsoftTeamsAppIdentifierConverter(\n  identifier: MicrosoftTeamsAppIdentifierModel | undefined,\n): MicrosoftTeamsAppIdentifier | undefined {\n  if (!identifier || !identifier.appId) {\n    return undefined;\n  }\n\n  return { teamsAppId: identifier.appId };\n}\n"]}