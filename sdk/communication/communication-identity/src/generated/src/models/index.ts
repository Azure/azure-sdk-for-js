/*
 * Copyright (c) Microsoft Corporation.
 * Licensed under the MIT License.
 *
 * Code generated by Microsoft (R) AutoRest Code Generator.
 * Changes may cause incorrect behavior and will be lost if the code is regenerated.
 */

import * as coreClient from "@azure/core-client";

export interface CommunicationIdentityCreateRequest {
  /** Also create access token for the created identity. */
  createTokenWithScopes?: CommunicationIdentityTokenScope[];
  /** Optional custom validity period of the token within [60,1440] minutes range. If not provided, the default value of 1440 minutes (24 hours) will be used. */
  expiresInMinutes?: number;
}

/** A communication identity with access token. */
export interface CommunicationIdentityAccessTokenResult {
  /** A communication identity. */
  identity: CommunicationIdentity;
  /** An access token. */
  accessToken?: CommunicationIdentityAccessToken;
}

/** A communication identity. */
export interface CommunicationIdentity {
  /** Identifier of the identity. */
  id: string;
}

/** An access token. */
export interface CommunicationIdentityAccessToken {
  /** The access token issued for the identity. */
  token: string;
  /** The expiry time of the token. */
  expiresOn: Date;
}

/** The Communication Services error. */
export interface CommunicationErrorResponse {
  /** The Communication Services error. */
  error: CommunicationError;
}

/** The Communication Services error. */
export interface CommunicationError {
  /** The error code. */
  code: string;
  /** The error message. */
  message: string;
  /**
   * The error target.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly target?: string;
  /**
   * Further details about specific errors that led to this error.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly details?: CommunicationError[];
  /**
   * The inner error if any.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly innerError?: CommunicationError;
}

export interface TeamsUserExchangeTokenRequest {
  /** Azure AD access token of a Teams User to acquire a new Communication Identity access token. */
  token: string;
  /** Client ID of an Azure AD application to be verified against the appid claim in the Azure AD access token. */
  appId: string;
  /** Object ID of an Azure AD user (Teams User) to be verified against the oid claim in the Azure AD access token. */
  userId: string;
}

export interface CommunicationIdentityAccessTokenRequest {
  /** List of scopes attached to the token. */
  scopes: CommunicationIdentityTokenScope[];
  /** Optional custom validity period of the token within [60,1440] minutes range. If not provided, the default value of 1440 minutes (24 hours) will be used. */
  expiresInMinutes?: number;
}

/** Known values of {@link CommunicationIdentityTokenScope} that the service accepts. */
export enum KnownCommunicationIdentityTokenScope {
  /** Use this for full access to Chat APIs. */
  Chat = "chat",
  /** Use this for full access to Calling APIs. */
  Voip = "voip",
  /** Access to Chat APIs but without the authorization to create, delete or update chat threads. */
  ChatJoin = "chat.join",
  /** A more limited version of chat.join that doesn't allow to add or remove participants. Use this scope when the token bearer is not fully trusted, for example in guest scenarios. */
  ChatJoinLimited = "chat.join.limited",
  /** Access to Calling APIs but without the authorization to start new calls. */
  VoipJoin = "voip.join"
}

/**
 * Defines values for CommunicationIdentityTokenScope. \
 * {@link KnownCommunicationIdentityTokenScope} can be used interchangeably with CommunicationIdentityTokenScope,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **chat**: Use this for full access to Chat APIs. \
 * **voip**: Use this for full access to Calling APIs. \
 * **chat.join**: Access to Chat APIs but without the authorization to create, delete or update chat threads. \
 * **chat.join.limited**: A more limited version of chat.join that doesn't allow to add or remove participants. Use this scope when the token bearer is not fully trusted, for example in guest scenarios. \
 * **voip.join**: Access to Calling APIs but without the authorization to start new calls.
 */
export type CommunicationIdentityTokenScope = string;

/** Optional parameters. */
export interface CommunicationIdentityCreateOptionalParams
  extends coreClient.OperationOptions {
  /** Also create access token for the created identity. */
  createTokenWithScopes?: CommunicationIdentityTokenScope[];
  /** Optional custom validity period of the token within [60,1440] minutes range. If not provided, the default value of 1440 minutes (24 hours) will be used. */
  expiresInMinutes?: number;
}

/** Contains response data for the create operation. */
export type CommunicationIdentityCreateResponse = CommunicationIdentityAccessTokenResult;

/** Optional parameters. */
export interface CommunicationIdentityDeleteOptionalParams
  extends coreClient.OperationOptions {}

/** Optional parameters. */
export interface CommunicationIdentityRevokeAccessTokensOptionalParams
  extends coreClient.OperationOptions {}

/** Optional parameters. */
export interface CommunicationIdentityExchangeTeamsUserAccessTokenOptionalParams
  extends coreClient.OperationOptions {}

/** Contains response data for the exchangeTeamsUserAccessToken operation. */
export type CommunicationIdentityExchangeTeamsUserAccessTokenResponse = CommunicationIdentityAccessToken;

/** Optional parameters. */
export interface CommunicationIdentityIssueAccessTokenOptionalParams
  extends coreClient.OperationOptions {
  /** Optional custom validity period of the token within [60,1440] minutes range. If not provided, the default value of 1440 minutes (24 hours) will be used. */
  expiresInMinutes?: number;
}

/** Contains response data for the issueAccessToken operation. */
export type CommunicationIdentityIssueAccessTokenResponse = CommunicationIdentityAccessToken;

/** Optional parameters. */
export interface IdentityRestClientOptionalParams
  extends coreClient.ServiceClientOptions {
  /** Api Version */
  apiVersion?: string;
  /** Overrides client endpoint. */
  endpoint?: string;
}
