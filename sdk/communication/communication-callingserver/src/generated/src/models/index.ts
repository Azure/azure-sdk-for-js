/*
 * Copyright (c) Microsoft Corporation.
 * Licensed under the MIT License.
 *
 * Code generated by Microsoft (R) AutoRest Code Generator.
 * Changes may cause incorrect behavior and will be lost if the code is regenerated.
 */

import * as coreHttp from "@azure/core-http";

/** The request payload for create call. */
export interface CreateCallRequest {
  /** The alternate identity of the source of the call if dialing out to a pstn number */
  alternateCallerId?: PhoneNumberIdentifierModel;
  /** The targets of the call. */
  targets: CommunicationIdentifierModel[];
  /** The source of the call. */
  source: CommunicationIdentifierModel;
  /** The subject. */
  subject?: string;
  /** The callback URI. */
  callbackUri: string;
  /** The requested modalities. */
  requestedMediaTypes?: MediaType[];
  /** The requested call events to subscribe to. */
  requestedCallEvents?: EventSubscriptionType[];
}

/** A phone number. */
export interface PhoneNumberIdentifierModel {
  /** The phone number in E.164 format. */
  value: string;
}

/** Identifies a participant in Azure Communication services. A participant is, for example, a phone number or an Azure communication user. This model must be interpreted as a union: Apart from rawId, at most one further property may be set. */
export interface CommunicationIdentifierModel {
  /** Raw Id of the identifier. Optional in requests, required in responses. */
  rawId?: string;
  /** The communication user. */
  communicationUser?: CommunicationUserIdentifierModel;
  /** The phone number. */
  phoneNumber?: PhoneNumberIdentifierModel;
  /** The Microsoft Teams user. */
  microsoftTeamsUser?: MicrosoftTeamsUserIdentifierModel;
}

/** A user that got created with an Azure Communication Services resource. */
export interface CommunicationUserIdentifierModel {
  /** The Id of the communication user. */
  id: string;
}

/** A Microsoft Teams user. */
export interface MicrosoftTeamsUserIdentifierModel {
  /** The Id of the Microsoft Teams user. If not anonymous, this is the AAD object Id of the user. */
  userId: string;
  /** True if the Microsoft Teams user is anonymous. By default false if missing. */
  isAnonymous?: boolean;
  /** The cloud that the Microsoft Teams user belongs to. By default 'public' if missing. */
  cloud?: CommunicationCloudEnvironmentModel;
}

/** The response payload of the create call operation. */
export interface CreateCallResult {
  /** The call connection id. */
  callConnectionId?: string;
}

/** The Communication Services error. */
export interface CommunicationErrorResponse {
  /** The Communication Services error. */
  error: CommunicationError;
}

/** The Communication Services error. */
export interface CommunicationError {
  /** The error code. */
  code: string;
  /** The error message. */
  message: string;
  /**
   * The error target.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly target?: string;
  /**
   * Further details about specific errors that led to this error.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly details?: CommunicationError[];
  /**
   * The inner error if any.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly innerError?: CommunicationError;
}

/** The request payload for playing audio. */
export interface PlayAudioRequest {
  /**
   * The media resource uri of the play audio request.
   * Currently only Wave file (.wav) format audio prompts are supported.
   * More specifically, the audio content in the wave file must be mono (single-channel),
   * 16-bit samples with a 16,000 (16KHz) sampling rate.
   */
  audioFileUri?: string;
  /** The flag indicating whether audio file needs to be played in loop or not. */
  loop?: boolean;
  /** The value to identify context of the operation. */
  operationContext?: string;
  /** An id for the media in the AudioFileUri, using which we cache the media resource. */
  audioFileId?: string;
  /** The callback Uri to receive PlayAudio status notifications. */
  callbackUri?: string;
}

/** The response payload for play audio operation. */
export interface PlayAudioResult {
  /** The operation id. */
  operationId?: string;
  /** The status of the operation */
  status: OperationStatus;
  /** The operation context provided by client. */
  operationContext?: string;
  /** The result info for the operation. */
  resultInfo?: ResultInfo;
}

/** Result info class to be used to report result status for actions/operations. */
export interface ResultInfo {
  /** The result code associated with the operation. */
  code: number;
  /** The subcode that further classifies the result. */
  subcode: number;
  /** The message is a detail explanation of subcode. */
  message?: string;
}

/** The request payload for cancel all media operations */
export interface CancelAllMediaOperationsRequest {
  /** The context for this operation. */
  operationContext?: string;
}

/** The response payload of the cancel all media operations. */
export interface CancelAllMediaOperationsResult {
  /** The operation id. */
  operationId?: string;
  /** The status of the operation */
  status: OperationStatus;
  /** The operation context provided by client. */
  operationContext?: string;
  /** The result info for the operation. */
  resultInfo?: ResultInfo;
}

/** The add participant request. */
export interface AddParticipantRequest {
  /** The alternate identity of source participant. */
  alternateCallerId?: PhoneNumberIdentifierModel;
  /** The participant to be added to the call. */
  participant?: CommunicationIdentifierModel;
  /** The operation context. */
  operationContext?: string;
  /** The callback URI. */
  callbackUri?: string;
}

/** The add participant result */
export interface AddParticipantResult {
  /** The id of the added participant. */
  participantId?: string;
}

/** The request payload start call recording operation. */
export interface StartCallRecordingRequest {
  /** The uri to send notifications to. */
  recordingStateCallbackUri?: string;
}

/** The response payload of start call recording operation. */
export interface StartCallRecordingResult {
  /** The recording id of the started recording */
  recordingId?: string;
}

/** The response payload of get call recording properties operation. */
export interface CallRecordingProperties {
  /** The state of the recording */
  recordingState: CallRecordingState;
}

/** The request payload for join call. */
export interface JoinCallRequest {
  /** The source of the call. */
  source: CommunicationIdentifierModel;
  /** The subject. */
  subject?: string;
  /** The callback URI. */
  callbackUri: string;
  /** The requested modalities. */
  requestedMediaTypes?: MediaType[];
  /** The requested call events to subscribe to. */
  requestedCallEvents?: EventSubscriptionType[];
}

/** The response payload of the join call operation. */
export interface JoinCallResult {
  /** The call connection id. */
  callConnectionId?: string;
}

/** The call connection state changed event. */
export interface CallConnectionStateChangedEvent {
  /** The server call.id. */
  serverCallId?: string;
  /** The call connection id. */
  callConnectionId?: string;
  /** The call connection state. */
  callConnectionState: CallConnectionState;
}

/** The call recording state change event. */
export interface CallRecordingStateChangeEvent {
  /** The call recording id */
  recordingId?: string;
  /** The state of the recording */
  state: CallRecordingState;
  /** The time of the recording started */
  startDateTime: Date;
  /** The server call.id. */
  serverCallId?: string;
}

export interface AddParticipantResultEvent {
  /** The result details. */
  resultInfo?: ResultInfo;
  /** The operation context. */
  operationContext?: string;
  /** The status of the operation */
  status: OperationStatus;
}

/** The participant update event */
export interface ParticipantsUpdatedEvent {
  /** The call connection id. */
  callConnectionId?: string;
  /** The list of participants. */
  participants?: CallParticipant[];
}

/** A participant in a call. */
export interface CallParticipant {
  /** Communication identifier of the participant */
  identifier?: CommunicationIdentifierModel;
  /** Participant id */
  participantId?: string;
  /** Is participant muted */
  isMuted: boolean;
}

/** The play audio result event. */
export interface PlayAudioResultEvent {
  /** The result details. */
  resultInfo?: ResultInfo;
  /** The operation context. */
  operationContext?: string;
  /** The status of the operation */
  status: OperationStatus;
}

/** The subscribe to tone event */
export interface ToneReceivedEvent {
  /** The tone info. */
  toneInfo: ToneInfo;
  /** The call connection id. */
  callConnectionId?: string;
}

/** The information about the tone. */
export interface ToneInfo {
  /** The sequence id which can be used to determine if the same tone was played multiple times or if any tones were missed. */
  sequenceId: number;
  /** The tone value. */
  tone: ToneValue;
}

/** Known values of {@link CommunicationCloudEnvironmentModel} that the service accepts. */
export const enum KnownCommunicationCloudEnvironmentModel {
  Public = "public",
  Dod = "dod",
  Gcch = "gcch"
}

/**
 * Defines values for CommunicationCloudEnvironmentModel. \
 * {@link KnownCommunicationCloudEnvironmentModel} can be used interchangeably with CommunicationCloudEnvironmentModel,
 *  this enum contains the known values that the service supports.
 * ### Know values supported by the service
 * **public** \
 * **dod** \
 * **gcch**
 */
export type CommunicationCloudEnvironmentModel = string;

/** Known values of {@link MediaType} that the service accepts. */
export const enum KnownMediaType {
  Audio = "audio",
  Video = "video"
}

/**
 * Defines values for MediaType. \
 * {@link KnownMediaType} can be used interchangeably with MediaType,
 *  this enum contains the known values that the service supports.
 * ### Know values supported by the service
 * **audio** \
 * **video**
 */
export type MediaType = string;

/** Known values of {@link EventSubscriptionType} that the service accepts. */
export const enum KnownEventSubscriptionType {
  ParticipantsUpdated = "participantsUpdated",
  DtmfReceived = "dtmfReceived"
}

/**
 * Defines values for EventSubscriptionType. \
 * {@link KnownEventSubscriptionType} can be used interchangeably with EventSubscriptionType,
 *  this enum contains the known values that the service supports.
 * ### Know values supported by the service
 * **participantsUpdated** \
 * **dtmfReceived**
 */
export type EventSubscriptionType = string;

/** Known values of {@link OperationStatus} that the service accepts. */
export const enum KnownOperationStatus {
  NotStarted = "notStarted",
  Running = "running",
  Completed = "completed",
  Failed = "failed"
}

/**
 * Defines values for OperationStatus. \
 * {@link KnownOperationStatus} can be used interchangeably with OperationStatus,
 *  this enum contains the known values that the service supports.
 * ### Know values supported by the service
 * **notStarted** \
 * **running** \
 * **completed** \
 * **failed**
 */
export type OperationStatus = string;

/** Known values of {@link CallRecordingState} that the service accepts. */
export const enum KnownCallRecordingState {
  Active = "active",
  Inactive = "inactive"
}

/**
 * Defines values for CallRecordingState. \
 * {@link KnownCallRecordingState} can be used interchangeably with CallRecordingState,
 *  this enum contains the known values that the service supports.
 * ### Know values supported by the service
 * **active** \
 * **inactive**
 */
export type CallRecordingState = string;

/** Known values of {@link CallConnectionState} that the service accepts. */
export const enum KnownCallConnectionState {
  Incoming = "incoming",
  Connecting = "connecting",
  Connected = "connected",
  Disconnecting = "disconnecting",
  Disconnected = "disconnected"
}

/**
 * Defines values for CallConnectionState. \
 * {@link KnownCallConnectionState} can be used interchangeably with CallConnectionState,
 *  this enum contains the known values that the service supports.
 * ### Know values supported by the service
 * **incoming** \
 * **connecting** \
 * **connected** \
 * **disconnecting** \
 * **disconnected**
 */
export type CallConnectionState = string;

/** Known values of {@link ToneValue} that the service accepts. */
export const enum KnownToneValue {
  Tone0 = "tone0",
  Tone1 = "tone1",
  Tone2 = "tone2",
  Tone3 = "tone3",
  Tone4 = "tone4",
  Tone5 = "tone5",
  Tone6 = "tone6",
  Tone7 = "tone7",
  Tone8 = "tone8",
  Tone9 = "tone9",
  Star = "star",
  Pound = "pound",
  A = "a",
  B = "b",
  C = "c",
  D = "d",
  Flash = "flash"
}

/**
 * Defines values for ToneValue. \
 * {@link KnownToneValue} can be used interchangeably with ToneValue,
 *  this enum contains the known values that the service supports.
 * ### Know values supported by the service
 * **tone0** \
 * **tone1** \
 * **tone2** \
 * **tone3** \
 * **tone4** \
 * **tone5** \
 * **tone6** \
 * **tone7** \
 * **tone8** \
 * **tone9** \
 * **star** \
 * **pound** \
 * **a** \
 * **b** \
 * **c** \
 * **d** \
 * **flash**
 */
export type ToneValue = string;

/** Contains response data for the createCall operation. */
export type CallConnectionsCreateCallResponse = CreateCallResult & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: CreateCallResult;
  };
};

/** Contains response data for the playAudio operation. */
export type CallConnectionsPlayAudioResponse = PlayAudioResult & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: PlayAudioResult;
  };
};

/** Contains response data for the cancelAllMediaOperations operation. */
export type CallConnectionsCancelAllMediaOperationsResponse = CancelAllMediaOperationsResult & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: CancelAllMediaOperationsResult;
  };
};

/** Contains response data for the addParticipant operation. */
export type CallConnectionsAddParticipantResponse = AddParticipantResult & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: AddParticipantResult;
  };
};

/** Contains response data for the addParticipant operation. */
export type ServerCallsAddParticipantResponse = AddParticipantResult & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: AddParticipantResult;
  };
};

/** Contains response data for the startRecording operation. */
export type ServerCallsStartRecordingResponse = StartCallRecordingResult & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: StartCallRecordingResult;
  };
};

/** Contains response data for the getRecordingProperties operation. */
export type ServerCallsGetRecordingPropertiesResponse = CallRecordingProperties & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: CallRecordingProperties;
  };
};

/** Contains response data for the joinCall operation. */
export type ServerCallsJoinCallResponse = JoinCallResult & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: JoinCallResult;
  };
};

/** Contains response data for the playAudio operation. */
export type ServerCallsPlayAudioResponse = PlayAudioResult & {
  /** The underlying HTTP response. */
  _response: coreHttp.HttpResponse & {
    /** The response body as text (string format) */
    bodyAsText: string;

    /** The response body as parsed JSON or XML */
    parsedBody: PlayAudioResult;
  };
};

/** Optional parameters. */
export interface CallingServerApiClientOptionalParams
  extends coreHttp.ServiceClientOptions {
  /** Api Version */
  apiVersion?: string;
  /** Overrides client endpoint. */
  endpoint?: string;
}
