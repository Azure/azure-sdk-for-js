{"version":3,"file":"chatThreadClient.js","sourceRoot":"","sources":["../../src/chatThreadClient.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport { logger } from \"./models/logger.js\";\nimport type {\n  CommunicationIdentifier,\n  CommunicationTokenCredential,\n} from \"@azure/communication-common\";\nimport { serializeCommunicationIdentifier } from \"@azure/communication-common\";\nimport type { PagedAsyncIterableIterator } from \"@azure/core-paging\";\nimport type {\n  AddParticipantsRequest,\n  SendMessageRequest,\n  SendReadReceiptRequest,\n} from \"./models/requests.js\";\n\nimport type {\n  AddChatParticipantsResult,\n  ChatMessage,\n  ChatMessageReadReceipt,\n  ChatParticipant,\n  ChatThreadProperties,\n  ListPageSettings,\n  SendChatMessageResult,\n} from \"./models/models.js\";\nimport {\n  mapToAddChatParticipantsRequestRestModel,\n  mapToChatMessageSdkModel,\n  mapToChatParticipantSdkModel,\n  mapToChatThreadPropertiesSdkModel,\n  mapToReadReceiptSdkModel,\n} from \"./models/mappers.js\";\nimport type {\n  AddParticipantsOptions,\n  ChatThreadClientOptions,\n  DeleteMessageOptions,\n  GetMessageOptions,\n  GetPropertiesOptions,\n  ListMessagesOptions,\n  ListParticipantsOptions,\n  ListReadReceiptsOptions,\n  RemoveParticipantOptions,\n  SendMessageOptions,\n  SendReadReceiptOptions,\n  SendTypingNotificationOptions,\n  UpdateMessageOptions,\n  UpdateTopicOptions,\n} from \"./models/options.js\";\nimport { ChatApiClient } from \"./generated/src/index.js\";\nimport type { InternalPipelineOptions } from \"@azure/core-rest-pipeline\";\nimport { createCommunicationTokenCredentialPolicy } from \"./credential/communicationTokenCredentialPolicy.js\";\nimport { tracingClient } from \"./generated/src/tracing.js\";\n\nconst minimumTypingIntervalInMilliSeconds: number = 8000;\n\n/**\n * The client to do chat operations\n */\nexport class ChatThreadClient {\n  /**\n   * Thread ID of the ChatThreadClient\n   */\n  readonly threadId: string;\n\n  private readonly tokenCredential: CommunicationTokenCredential;\n  private readonly client: ChatApiClient;\n\n  private timeOfLastTypingRequest: Date | undefined = undefined;\n\n  constructor(\n    private readonly endpoint: string,\n    threadId: string,\n    credential: CommunicationTokenCredential,\n    options: ChatThreadClientOptions = {},\n  ) {\n    this.threadId = threadId;\n    this.tokenCredential = credential;\n\n    const internalPipelineOptions: InternalPipelineOptions = {\n      ...options,\n      ...{\n        loggingOptions: {\n          logger: logger.info,\n        },\n      },\n    };\n\n    this.client = new ChatApiClient(this.endpoint, {\n      endpoint: this.endpoint,\n      ...internalPipelineOptions,\n    });\n\n    const authPolicy = createCommunicationTokenCredentialPolicy(this.tokenCredential);\n    this.client.pipeline.addPolicy(authPolicy);\n  }\n\n  /**\n   * Gets a chat thread.\n   * Returns the chat thread.\n   * @param options -  Operation options.\n   */\n  public getProperties(options: GetPropertiesOptions = {}): Promise<ChatThreadProperties> {\n    return tracingClient.withSpan(\"ChatClient-GetProperties\", options, async (updatedOptions) => {\n      const result = await this.client.chatThread.getChatThreadProperties(\n        this.threadId,\n        updatedOptions,\n      );\n      return mapToChatThreadPropertiesSdkModel(result);\n    });\n  }\n\n  /**\n   * Updates a thread's topic.\n   * @param topic - The topic needs to be updated to.\n   * @param options - Operation options.\n   */\n  public updateTopic(topic: string, options: UpdateTopicOptions = {}): Promise<void> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-UpdateTopic\",\n      options,\n      async (updatedOptions) => {\n        await this.client.chatThread.updateChatThreadProperties(\n          this.threadId,\n          { topic: topic },\n          updatedOptions,\n        );\n      },\n    );\n  }\n\n  /**\n   * Sends a chat message to a thread identified by threadId.\n   * Returns the id of the created message.\n   * @param request - Request for sending a message.\n   * @param options - Operation options.\n   */\n  public sendMessage(\n    request: SendMessageRequest,\n    options: SendMessageOptions = {},\n  ): Promise<SendChatMessageResult> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-SendMessage\",\n      options,\n      async (updatedOptions) => {\n        // reset typing notification clock\n        this.timeOfLastTypingRequest = undefined;\n\n        const result = await this.client.chatThread.sendChatMessage(\n          this.threadId,\n          { ...request, ...options },\n          updatedOptions,\n        );\n        return result;\n      },\n    );\n  }\n\n  /**\n   * Gets a chat message identified by messageId.\n   * Returns the specific message.\n   * @param messageId - The message id of the message.\n   * @param options - Operation options.\n   */\n  public getMessage(messageId: string, options: GetMessageOptions = {}): Promise<ChatMessage> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-GetMessage\",\n      options,\n      async (updatedOptions) => {\n        const result = await this.client.chatThread.getChatMessage(\n          this.threadId,\n          messageId,\n          updatedOptions,\n        );\n        return mapToChatMessageSdkModel(result);\n      },\n    );\n  }\n\n  private async *listMessagesPage(\n    pageSettings: ListPageSettings,\n    options: ListMessagesOptions = {},\n  ): AsyncIterableIterator<ChatMessage[]> {\n    if (!pageSettings.continuationToken) {\n      const currentSetResponse = await this.client.chatThread.listChatMessages(\n        this.threadId,\n        options,\n      );\n      pageSettings.continuationToken = currentSetResponse.nextLink;\n      if (currentSetResponse.value) {\n        yield currentSetResponse.value.map(mapToChatMessageSdkModel, this);\n      }\n    }\n\n    while (pageSettings.continuationToken) {\n      const currentSetResponse = await this.client.chatThread.listChatMessagesNext(\n        this.threadId,\n        pageSettings.continuationToken,\n        options,\n      );\n      pageSettings.continuationToken = currentSetResponse.nextLink;\n      if (currentSetResponse.value) {\n        yield currentSetResponse.value.map(mapToChatMessageSdkModel, this);\n      } else {\n        break;\n      }\n    }\n  }\n\n  private async *listMessagesAll(options: ListMessagesOptions): AsyncIterableIterator<ChatMessage> {\n    for await (const page of this.listMessagesPage({}, options)) {\n      yield* page;\n    }\n  }\n\n  /**\n   * Gets a list of message from a thread identified by threadId.\n   * Returns the list of the messages.\n   * @param options - Get messages options.\n   */\n  public listMessages(options: ListMessagesOptions = {}): PagedAsyncIterableIterator<ChatMessage> {\n    const { span, updatedOptions } = tracingClient.startSpan(\n      \"ChatThreadClient-ListMessages\",\n      options,\n    );\n\n    try {\n      const iter = this.listMessagesAll(updatedOptions);\n      return {\n        next() {\n          return iter.next();\n        },\n        [Symbol.asyncIterator]() {\n          return this;\n        },\n        byPage: (settings: ListPageSettings = {}) => {\n          return this.listMessagesPage(settings, updatedOptions);\n        },\n      };\n    } catch (e: any) {\n      span.setStatus({\n        status: \"error\",\n        error: e,\n      });\n      throw e;\n    } finally {\n      span.end();\n    }\n  }\n\n  /**\n   * Deletes a message identified by threadId and messageId\n   * @param messageId - The message id of the message.\n   * @param options - Operation options.\n   */\n  public deleteMessage(messageId: string, options: DeleteMessageOptions = {}): Promise<void> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-DeleteMessage\",\n      options,\n      async (updatedOptions) => {\n        await this.client.chatThread.deleteChatMessage(this.threadId, messageId, updatedOptions);\n      },\n    );\n  }\n\n  /**\n   * Updates a message identified by threadId and messageId\n   * @param messageId - The message id of the message.\n   * @param options - Operation options.\n   */\n  public async updateMessage(messageId: string, options: UpdateMessageOptions = {}): Promise<void> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-UpdateMessage\",\n      options,\n      async (updatedOptions) => {\n        await this.client.chatThread.updateChatMessage(\n          this.threadId,\n          messageId,\n          options,\n          updatedOptions,\n        );\n      },\n    );\n  }\n\n  /**\n   * Adds the details of chat participants belonging to the thread identified by threadId.\n   * @param request - Thread participants' details to add in the thread roster\n   * @param options - Operation options.\n   */\n  public async addParticipants(\n    request: AddParticipantsRequest,\n    options: AddParticipantsOptions = {},\n  ): Promise<AddChatParticipantsResult> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-AddParticipants\",\n      options,\n      async (updatedOptions) => {\n        const result = await this.client.chatThread.addChatParticipants(\n          this.threadId,\n          mapToAddChatParticipantsRequestRestModel(request),\n          updatedOptions,\n        );\n        return result;\n      },\n    );\n  }\n\n  private async *listParticipantsPage(\n    continuationState: ListPageSettings,\n    options: ListParticipantsOptions = {},\n  ): AsyncIterableIterator<ChatParticipant[]> {\n    if (!continuationState.continuationToken) {\n      const currentSetResponse = await this.client.chatThread.listChatParticipants(\n        this.threadId,\n        options,\n      );\n      continuationState.continuationToken = currentSetResponse.nextLink;\n      if (currentSetResponse.value) {\n        yield currentSetResponse.value.map(mapToChatParticipantSdkModel, this);\n      }\n    }\n\n    while (continuationState.continuationToken) {\n      const currentSetResponse = await this.client.chatThread.listChatParticipantsNext(\n        this.threadId,\n        continuationState.continuationToken,\n        options,\n      );\n      continuationState.continuationToken = currentSetResponse.nextLink;\n      if (currentSetResponse.value) {\n        yield currentSetResponse.value.map(mapToChatParticipantSdkModel, this);\n      } else {\n        break;\n      }\n    }\n  }\n\n  private async *listParticipantsAll(\n    options: ListParticipantsOptions,\n  ): AsyncIterableIterator<ChatParticipant> {\n    for await (const page of this.listParticipantsPage({}, options)) {\n      yield* page;\n    }\n  }\n\n  /**\n   * Gets the participants of the thread identified by threadId.\n   * Returns the lists of the participants.\n   * @param options - Operation options.\n   */\n  public listParticipants(\n    options: ListParticipantsOptions = {},\n  ): PagedAsyncIterableIterator<ChatParticipant> {\n    const { span, updatedOptions } = tracingClient.startSpan(\n      \"ChatThreadClient-ListParticipants\",\n      options,\n    );\n\n    try {\n      const iter = this.listParticipantsAll(updatedOptions);\n      return {\n        next() {\n          return iter.next();\n        },\n        [Symbol.asyncIterator]() {\n          return this;\n        },\n        byPage: (settings: ListPageSettings = {}) => {\n          return this.listParticipantsPage(settings, updatedOptions);\n        },\n      };\n    } catch (e: any) {\n      span.setStatus({\n        status: \"error\",\n        error: e,\n      });\n      throw e;\n    } finally {\n      span.end();\n    }\n  }\n\n  /**\n   * Removes participant from the thread identified by threadId.\n   * @param participant - Thread participant to remove from the thread roster\n   * @param options - Operation options.\n   */\n  public async removeParticipant(\n    participant: CommunicationIdentifier,\n    options: RemoveParticipantOptions = {},\n  ): Promise<void> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-RemoveParticipant\",\n      options,\n      async (updatedOptions) => {\n        await this.client.chatThread.removeChatParticipant(\n          this.threadId,\n          serializeCommunicationIdentifier(participant),\n          updatedOptions,\n        );\n      },\n    );\n  }\n\n  /**\n   * Sends a typing notification to the thread.\n   * Doesn't attempt to send if the time since last notification is smaller than the minimum typing interval\n   * @param options - - Operation options\n   * @returns True if the typing message notification could be sent, otherwise false.\n   */\n  public async sendTypingNotification(\n    options: SendTypingNotificationOptions = {},\n  ): Promise<boolean> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-SendTypingNotification\",\n      options,\n      async (updatedOptions) => {\n        const dateNow = new Date();\n        const { senderDisplayName, ...restOptions } = updatedOptions;\n\n        if (this.canPostTypingNotification(dateNow)) {\n          this.timeOfLastTypingRequest = dateNow;\n\n          await this.client.chatThread.sendTypingNotification(this.threadId, {\n            sendTypingNotificationRequest: { senderDisplayName: senderDisplayName },\n            ...restOptions,\n          });\n          return true;\n        }\n\n        logger.info(`Typing Notification NOT Send. [thread_id=${this.threadId}]`);\n        return false;\n      },\n    );\n  }\n\n  /**\n   * Sends a read receipt to the thread identified by threadId.\n   * @param request - Request for sending a read receipt\n   * @param options - Operation options.\n   */\n  public async sendReadReceipt(\n    request: SendReadReceiptRequest,\n    options: SendReadReceiptOptions = {},\n  ): Promise<void> {\n    return tracingClient.withSpan(\n      \"ChatThreadClient-SendReadReceipt\",\n      options,\n      async (updatedOptions) => {\n        await this.client.chatThread.sendChatReadReceipt(this.threadId, request, updatedOptions);\n      },\n    );\n  }\n\n  private async *listReadReceiptsPage(\n    continuationState: ListPageSettings,\n    options: ListReadReceiptsOptions = {},\n  ): AsyncIterableIterator<ChatMessageReadReceipt[]> {\n    if (!continuationState.continuationToken) {\n      const currentSetResponse = await this.client.chatThread.listChatReadReceipts(\n        this.threadId,\n        options,\n      );\n      continuationState.continuationToken = currentSetResponse.nextLink;\n      if (currentSetResponse.value) {\n        yield currentSetResponse.value.map(mapToReadReceiptSdkModel, this);\n      }\n    }\n\n    while (continuationState.continuationToken) {\n      const currentSetResponse = await this.client.chatThread.listChatReadReceiptsNext(\n        this.threadId,\n        continuationState.continuationToken,\n        options,\n      );\n      continuationState.continuationToken = currentSetResponse.nextLink;\n      if (currentSetResponse.value) {\n        yield currentSetResponse.value.map(mapToReadReceiptSdkModel, this);\n      } else {\n        break;\n      }\n    }\n  }\n\n  private async *listReadReceiptsAll(\n    options: ListReadReceiptsOptions,\n  ): AsyncIterableIterator<ChatMessageReadReceipt> {\n    for await (const page of this.listReadReceiptsPage({}, options)) {\n      yield* page;\n    }\n  }\n\n  /**\n   * Gets a list of read receipt from a thread identified by threadId.\n   * Returns the list of the messages.\n   * @param options - Get messages options.\n   */\n  public listReadReceipts(\n    options: ListReadReceiptsOptions = {},\n  ): PagedAsyncIterableIterator<ChatMessageReadReceipt> {\n    const { span, updatedOptions } = tracingClient.startSpan(\n      \"ChatThreadClient-ListChatReadReceipts\",\n      options,\n    );\n\n    try {\n      const iter = this.listReadReceiptsAll(updatedOptions);\n      return {\n        next() {\n          return iter.next();\n        },\n        [Symbol.asyncIterator]() {\n          return this;\n        },\n        byPage: (settings: ListPageSettings = {}) => {\n          return this.listReadReceiptsPage(settings, updatedOptions);\n        },\n      };\n    } catch (e: any) {\n      span.setStatus({\n        status: \"error\",\n        error: e,\n      });\n      throw e;\n    } finally {\n      span.end();\n    }\n  }\n\n  private canPostTypingNotification(dateNow: Date): boolean {\n    if (this.timeOfLastTypingRequest) {\n      const timeSinceLastRequestInMilliSeconds =\n        dateNow.getTime() - this.timeOfLastTypingRequest.getTime();\n\n      if (timeSinceLastRequestInMilliSeconds < minimumTypingIntervalInMilliSeconds) {\n        logger.info(`Typing interval check failed. [last_request=${this.timeOfLastTypingRequest}]`);\n        return false;\n      }\n    }\n\n    return true;\n  }\n}\n"]}