{"version":3,"file":"checkNetworkConnection.js","sourceRoot":"","sources":["../../../src/util/checkNetworkConnection.ts"],"names":[],"mappings":";AAAA,uCAAuC;AACvC,kCAAkC;;AASlC,wDAsBC;AA7BD,uCAAuE;AACvE,sCAAmC;AAEnC;;;GAGG;AACH,SAAgB,sBAAsB,CAAC,IAAY;IACjD,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE;QAC7B,eAAM,CAAC,OAAO,CAAC,6DAA6D,CAAC,CAAC;QAC9E,IAAA,kBAAU,EAAC,IAAI,EAAE,UAAU,GAAQ;YACjC,IAAI,GAAG,EAAE,CAAC;gBACR,eAAM,CAAC,OAAO,CACZ,qEAAqE,EACrE,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,IAAI,EACpB,GAAG,CACJ,CAAC;gBACF,2GAA2G;gBAC3G,8GAA8G;gBAC9G,IAAI,GAAG,CAAC,IAAI,KAAK,sBAAW,IAAI,GAAG,CAAC,IAAI,KAAK,kBAAO,EAAE,CAAC;oBACrD,OAAO,OAAO,CAAC,KAAK,CAAC,CAAC;gBACxB,CAAC;YACH,CAAC;iBAAM,CAAC;gBACN,eAAM,CAAC,OAAO,CAAC,yEAAyE,CAAC,CAAC;YAC5F,CAAC;YAED,OAAO,OAAO,CAAC,IAAI,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\n\nimport { CONNREFUSED, TIMEOUT, resolve as dnsResolve } from \"node:dns\";\nimport { logger } from \"../log.js\";\n\n/**\n * Checks whether a network connection is detected.\n * @internal\n */\nexport function checkNetworkConnection(host: string): Promise<boolean> {\n  return new Promise((resolve) => {\n    logger.verbose(\"Calling dns.resolve to determine network connection status.\");\n    dnsResolve(host, function (err: any): void {\n      if (err) {\n        logger.verbose(\n          \"Error thrown from dns.resolve in network connection check: '%s', %O\",\n          err.code || err.name,\n          err,\n        );\n        // List of possible DNS error codes: https://nodejs.org/dist/latest-v12.x/docs/api/dns.html#dns_error_codes\n        // We only resolve with `false` when dnsResolve fails with an error we expect to see when the network is down.\n        if (err.code === CONNREFUSED || err.code === TIMEOUT) {\n          return resolve(false);\n        }\n      } else {\n        logger.verbose(\"Successfully resolved host via dns.resolve in network connection check.\");\n      }\n\n      return resolve(true);\n    });\n  });\n}\n"]}