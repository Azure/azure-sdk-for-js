{
  "swagger": "2.0",
  "info": {
    "version": "2020-09-15_Preview",
    "title": "ApplicationInsightsClient",
    "description": "This document describes the protocol for client requests and responses to the data collection endpoint."
  },
  "x-ms-parameterized-host": {
    "hostTemplate": "{Host}/v2/",
    "useSchemePrefix": false,
    "parameters": [
      {
        "$ref": "#/parameters/Host"
      }
    ]
  },
  "paths": {
    "/track": {
      "post": {
        "summary": "Detect anomalies for the entire series in batch.",
        "description": "This operation generates a model using an entire series, each point is detected with the same model. With this method, points before and after a certain point are used to determine whether it is an anomaly. The entire detection can give user an overall status of the time series.",
        "operationId": "track",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "description": "Time series points and period if needed. Advanced model parameters can also be set in the request.",
            "required": true,
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/TelemetryEnvelope"
              }
            }
          }
        ],
        "consumes": ["application/json", "x-json-stream"],
        "produces": ["application/json"],
        "responses": {
          "200": {
            "description": "All of the telemetry items were accepted and processed.",
            "schema": {
              "$ref": "#/definitions/TrackResponse"
            }
          },
          "206": {
            "description": "Partial success. Some of the telemetry items were accepted and processed.",
            "schema": {
              "$ref": "#/definitions/TrackResponse"
            }
          },
          "400": {
            "description": "Bad Request",
            "schema": {
              "$ref": "#/definitions/TrackResponse"
            }
          },
          "402": {
            "description": "Payment Required",
            "schema": {
              "$ref": "#/definitions/TrackResponse"
            }
          },
          "429": {
            "description": "Too Many Requests",
            "schema": {
              "$ref": "#/definitions/TrackResponse"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/TrackResponse"
            }
          },
          "503": {
            "description": "Service Unavailable",
            "schema": {
              "$ref": "#/definitions/TrackResponse"
            }
          }
        },
        "x-ms-examples": {
          "Track examples": {
            "$ref": ".//examples//track.json"
          }
        }
      }
    }
  },
  "definitions": {
    "Base": {
      "x-ms-client-name": "MonitorBase",
      "type": "object",
      "description": "Data struct to contain only C section with custom fields.",
      "properties": {
        "baseType": {
          "type": "string",
          "description": "Name of item (B section) if any. If telemetry data is derived straight from this, this should be null."
        },
        "baseData": {
          "additionalProperties": true,
          "$ref": "#/definitions/Domain",
          "description": "The data payload for the telemetry request"
        }
      }
    },
    "Domain": {
      "x-ms-client-name": "MonitorDomain",
      "type": "object",
      "description": "The abstract common base of all domains.",
      "discriminator": "typename",
      "required": ["typename", "ver"],
      "properties": {
        "ver": {
          "x-ms-client-name": "version",
          "type": "integer",
          "format": "int32",
          "description": "Schema version",
          "default": 2
        },
        "typename": {
          "type": "string"
        }
      }
    },
    "RemoteDependencyData": {
      "allOf": [
        {
          "$ref": "#/definitions/Domain"
        },
        {
          "type": "object",
          "description": "An instance of Remote Dependency represents an interaction of the monitored component with a remote component/service like SQL or an HTTP endpoint.",
          "required": ["name", "duration"],
          "properties": {
            "id": {
              "type": "string",
              "description": "Identifier of a dependency call instance. Used for correlation with the request telemetry item corresponding to this dependency call.",
              "maxLength": 512
            },
            "name": {
              "type": "string",
              "description": "Name of the command initiated with this dependency call. Low cardinality value. Examples are stored procedure name and URL path template.",
              "maxLength": 1024
            },
            "resultCode": {
              "type": "string",
              "description": "Result code of a dependency call. Examples are SQL error code and HTTP status code.",
              "maxLength": 1024
            },
            "data": {
              "type": "string",
              "description": "Command initiated by this dependency call. Examples are SQL statement and HTTP URL with all query parameters.",
              "maxLength": 8192
            },
            "type": {
              "type": "string",
              "description": "Dependency type name. Very low cardinality value for logical grouping of dependencies and interpretation of other fields like commandName and resultCode. Examples are SQL, Azure table, and HTTP.",
              "maxLength": 1024
            },
            "target": {
              "type": "string",
              "description": "Target site of a dependency call. Examples are server name, host address.",
              "maxLength": 1024
            },
            "duration": {
              "type": "string",
              "description": "Request duration in format: DD.HH:MM:SS.MMMMMM. Must be less than 1000 days."
            },
            "success": {
              "type": "boolean",
              "description": "Indication of successful or unsuccessful call.",
              "default": true
            },
            "properties": {
              "type": "object",
              "description": "Collection of custom properties.",
              "additionalProperties": {
                "type": "string",
                "maxLength": 8192
              }
            },
            "measurements": {
              "type": "object",
              "description": "Collection of custom measurements.",
              "additionalProperties": {
                "type": "number",
                "format": "double"
              }
            }
          }
        }
      ]
    },
    "RequestData": {
      "allOf": [
        {
          "$ref": "#/definitions/Domain"
        },
        {
          "type": "object",
          "description": "An instance of PageView represents a generic action on a page like a button click. It is also the base type for PageView.",
          "required": ["id", "duration", "responseCode", "success"],
          "properties": {
            "id": {
              "type": "string",
              "description": "Identifier of a request call instance. Used for correlation between request and other telemetry items.",
              "maxLength": 512
            },
            "name": {
              "type": "string",
              "description": "Name of the request. Represents code path taken to process request. Low cardinality value to allow better grouping of requests. For HTTP requests it represents the HTTP method and URL path template like 'GET /values/{id}'.",
              "maxLength": 1024
            },
            "duration": {
              "type": "string",
              "description": "Request duration in format: DD.HH:MM:SS.MMMMMM. Must be less than 1000 days."
            },
            "success": {
              "type": "boolean",
              "description": "Indication of successful or unsuccessful call.",
              "default": true
            },
            "responseCode": {
              "type": "string",
              "description": "Result of a request execution. HTTP status code for HTTP requests.",
              "maxLength": 1024
            },
            "source": {
              "type": "string",
              "description": "Source of the request. Examples are the instrumentation key of the caller or the ip address of the caller.",
              "maxLength": 1024
            },
            "url": {
              "type": "string",
              "description": "Request URL with all query string parameters.",
              "maxLength": 2048
            },
            "properties": {
              "type": "object",
              "description": "Collection of custom properties.",
              "additionalProperties": {
                "type": "string",
                "maxLength": 8192
              }
            },
            "measurements": {
              "type": "object",
              "description": "Collection of custom measurements.",
              "additionalProperties": {
                "type": "number",
                "format": "double"
              }
            }
          }
        }
      ]
    },
    "TrackResponse": {
      "description": "Response containing the status of each telemetry item.",
      "type": "object",
      "properties": {
        "itemsReceived": {
          "type": "number",
          "format": "int32",
          "description": "The number of items received."
        },
        "itemsAccepted": {
          "type": "number",
          "format": "int32",
          "description": "The number of items accepted."
        },
        "errors": {
          "type": "array",
          "description": "An array of error detail objects.",
          "items": {
            "$ref": "#/definitions/ErrorDetails"
          }
        }
      }
    },
    "ErrorDetails": {
      "x-ms-client-name": "TelemetryErrorDetails",
      "description": "The error details",
      "type": "object",
      "properties": {
        "index": {
          "type": "number",
          "format": "int32",
          "description": "The index in the original payload of the item."
        },
        "statusCode": {
          "type": "number",
          "format": "int32",
          "description": "The item specific [HTTP Response status code](#Response Status Codes)."
        },
        "message": {
          "type": "string",
          "description": "The error message."
        }
      }
    },
    "TelemetryEnvelope": {
      "x-ms-client-name": "TelemetryItem",
      "description": "System variables for a telemetry item.",
      "type": "object",
      "required": ["name", "time"],
      "properties": {
        "ver": {
          "type": "number",
          "x-ms-client-name": "version",
          "format": "int32",
          "default": 1,
          "description": "Envelope version. For internal use only. By assigning this the default, it will not be serialized within the payload unless changed to a value other than #1."
        },
        "name": {
          "type": "string",
          "description": "Type name of telemetry data item."
        },
        "time": {
          "type": "string",
          "format": "date-time",
          "description": "Event date time when telemetry item was created. This is the wall clock time on the client when the event was generated. There is no guarantee that the client's time is accurate. This field must be formatted in UTC ISO 8601 format, with a trailing 'Z' character, as described publicly on https://en.wikipedia.org/wiki/ISO_8601#UTC. Note: the number of decimal seconds digits provided are variable (and unspecified). Consumers should handle this, i.e. managed code consumers should not use format 'O' for parsing as it specifies a fixed length. Example: 2009-06-15T13:45:30.0000000Z."
        },
        "sampleRate": {
          "type": "number",
          "format": "float",
          "default": 100.0,
          "description": "Sampling rate used in application. This telemetry item represents 1 / sampleRate actual telemetry items."
        },
        "seq": {
          "type": "string",
          "x-ms-client-name": "sequence",
          "maxLength": 64,
          "description": "Sequence field used to track absolute order of uploaded events."
        },
        "iKey": {
          "type": "string",
          "x-ms-client-name": "instrumentationKey",
          "description": "The instrumentation key of the Application Insights resource."
        },
        "tags": {
          "type": "object",
          "description": "Key/value collection of context properties. See ContextTagKeys for information on available properties.",
          "additionalProperties": {
            "type": "string"
          }
        },
        "data": {
          "$ref": "#/definitions/Base",
          "description": "Telemetry data item."
        }
      }
    },
    "ContextTagKeys": {
      "type": "string",
      "description": "The context tag keys.",
      "enum": [
        "ApplicationVersion",
        "DeviceId",
        "DeviceLocale",
        "DeviceModel",
        "DeviceOEMName",
        "DeviceOSVersion",
        "DeviceType",
        "LocationIp",
        "LocationCountry",
        "LocationProvince",
        "LocationCity",
        "OperationId",
        "OperationName",
        "OperationParentId",
        "OperationSyntheticSource",
        "OperationCorrelationVector",
        "SessionId",
        "SessionIsFirst",
        "UserAccountId",
        "UserId",
        "UserAuthUserId",
        "CloudRole",
        "CloudRoleVer",
        "CloudRoleInstance",
        "CloudLocation",
        "InternalSdkVersion",
        "InternalAgentVersion",
        "InternalNodeName  "
      ],
      "x-ms-enum": {
        "name": "ContextTagKeys",
        "modelAsString": true,
        "values": [
          {
            "value": "ai.application.ver"
          },
          {
            "value": "ai.device.id"
          },
          {
            "value": "ai.device.locale"
          },
          {
            "value": "ai.device.model"
          },
          {
            "value": "ai.device.oemName"
          },
          {
            "value": "ai.device.osVersion"
          },
          {
            "value": "ai.device.type"
          },
          {
            "value": "ai.location.ip"
          },
          {
            "value": "ai.location.country"
          },
          {
            "value": "ai.location.province"
          },
          {
            "value": "ai.location.city"
          },
          {
            "value": "ai.operation.id"
          },
          {
            "value": "ai.operation.name"
          },
          {
            "value": "ai.operation.parentId"
          },
          {
            "value": "ai.operation.syntheticSource"
          },
          {
            "value": "ai.operation.correlationVector"
          },
          {
            "value": "ai.session.id"
          },
          {
            "value": "ai.session.isFirst"
          },
          {
            "value": "ai.user.accountId"
          },
          {
            "value": "ai.user.id"
          },
          {
            "value": "ai.user.authUserId"
          },
          {
            "value": "ai.cloud.role"
          },
          {
            "value": "ai.cloud.roleVer"
          },
          {
            "value": "ai.cloud.roleInstance"
          },
          {
            "value": "ai.cloud.location"
          },
          {
            "value": "ai.internal.sdkVersion"
          },
          {
            "value": "ai.internal.agentVersion"
          },
          {
            "value": "ai.internal.nodeName"
          }
        ]
      }
    }
  },
  "parameters": {
    "Host": {
      "name": "Host",
      "description": "Breeze endpoint: https://dc.services.visualstudio.com",
      "x-ms-parameter-location": "client",
      "default": "https://dc.services.visualstudio.com",
      "required": true,
      "type": "string",
      "in": "path",
      "x-ms-skip-url-encoding": true
    }
  }
}
