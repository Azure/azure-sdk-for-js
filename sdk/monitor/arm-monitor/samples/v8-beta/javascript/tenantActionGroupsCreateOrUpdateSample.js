/*
 * Copyright (c) Microsoft Corporation.
 * Licensed under the MIT License.
 *
 * Code generated by Microsoft (R) AutoRest Code Generator.
 * Changes may cause incorrect behavior and will be lost if the code is regenerated.
 */

// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.
const { MonitorClient } = require("@azure/arm-monitor");
const { DefaultAzureCredential } = require("@azure/identity");
require("dotenv").config();

/**
 * This sample demonstrates how to Create a new tenant action group or update an existing one.
 *
 * @summary Create a new tenant action group or update an existing one.
 * x-ms-original-file: specification/monitor/resource-manager/Microsoft.Insights/preview/2023-05-01-preview/examples/createOrUpdateTenantActionGroup.json
 */
async function createOrUpdateATenantActionGroup() {
  const managementGroupId = "72f988bf-86f1-41af-91ab-2d7cd011db47";
  const tenantActionGroupName = "testTenantActionGroup";
  const xMsClientTenantId = "72f988bf-86f1-41af-91ab-2d7cd011db47";
  const actionGroup = {
    azureAppPushReceivers: [{ name: "Sample azureAppPush", emailAddress: "johndoe@email.com" }],
    emailReceivers: [
      {
        name: "John Doe's email",
        emailAddress: "johndoe@email.com",
        useCommonAlertSchema: false,
      },
      {
        name: "Jane Smith's email",
        emailAddress: "janesmith@email.com",
        useCommonAlertSchema: true,
      },
    ],
    enabled: true,
    groupShortName: "sample",
    location: "Global",
    smsReceivers: [
      {
        name: "John Doe's mobile",
        countryCode: "1",
        phoneNumber: "2062022299",
      },
      {
        name: "Jane Smith's mobile",
        countryCode: "1",
        phoneNumber: "0987654321",
      },
    ],
    tags: {},
    voiceReceivers: [{ name: "Sample voice", countryCode: "1", phoneNumber: "2062022299" }],
    webhookReceivers: [
      {
        name: "Sample webhook 1",
        serviceUri: "http://www.example.com/webhook1",
        useCommonAlertSchema: true,
      },
      {
        name: "Sample webhook 2",
        identifierUri: "http://someidentifier/d7811ba3-7996-4a93-99b6-6b2f3f355f8a",
        objectId: "d3bb868c-fe44-452c-aa26-769a6538c808",
        serviceUri: "http://www.example.com/webhook2",
        tenantId: "68a4459a-ccb8-493c-b9da-dd30457d1b84",
        useAadAuth: true,
        useCommonAlertSchema: true,
      },
    ],
  };
  const credential = new DefaultAzureCredential();
  const client = new MonitorClient(credential);
  const result = await client.tenantActionGroups.createOrUpdate(
    managementGroupId,
    tenantActionGroupName,
    xMsClientTenantId,
    actionGroup,
  );
  console.log(result);
}

async function main() {
  createOrUpdateATenantActionGroup();
}

main().catch(console.error);
