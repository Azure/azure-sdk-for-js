/*
 * Copyright (c) Microsoft Corporation.
 * Licensed under the MIT License.
 *
 * Code generated by Microsoft (R) AutoRest Code Generator.
 * Changes may cause incorrect behavior and will be lost if the code is regenerated.
 */

import * as coreClient from "@azure/core-client";
import * as coreHttpCompat from "@azure/core-http-compat";

export type KnowledgeAgentMessageContentUnion =
  | KnowledgeAgentMessageContent
  | KnowledgeAgentMessageTextContent
  | KnowledgeAgentMessageImageContent;
export type KnowledgeAgentActivityRecordUnion =
  | KnowledgeAgentActivityRecord
  | KnowledgeAgentSearchActivityRecord
  | KnowledgeAgentModelQueryPlanningActivityRecord
  | KnowledgeAgentSemanticRankerActivityRecord;
export type KnowledgeAgentReferenceUnion =
  | KnowledgeAgentReference
  | KnowledgeAgentAzureSearchDocReference;

/** The input contract for the retrieval request. */
export interface KnowledgeAgentRetrievalRequest {
  messages: KnowledgeAgentMessage[];
  targetIndexParams?: KnowledgeAgentIndexParams[];
}

/** The natural language message style object. */
export interface KnowledgeAgentMessage {
  /** The role of the tool response. */
  role: string;
  content: KnowledgeAgentMessageContentUnion[];
}

/** Specifies the type of the message content. */
export interface KnowledgeAgentMessageContent {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "text" | "image";
}

export interface KnowledgeAgentIndexParams {
  /** The name of the index the params apply to. */
  indexName?: string;
  /** A filter condition applied to the index (e.g., 'State eq VA'). */
  filterAddOn?: string;
  /** Limits the number of documents considered for ranking. */
  maxDocsForReranker?: number;
  /** A threshold for reranking results (range: 0-4). */
  rerankerThreshold?: number;
  /** Indicates whether reference source data should be included. */
  includeReferenceSourceData?: boolean;
}

/** The output contract for the retrieval response. */
export interface KnowledgeAgentRetrievalResponse {
  response?: KnowledgeAgentMessage[];
  /** The activity records for tracking progress and billing implications. */
  activity?: KnowledgeAgentActivityRecordUnion[];
  /** The references for the retrieval data used in the response. */
  references?: KnowledgeAgentReferenceUnion[];
}

/** Base type for activity records. */
export interface KnowledgeAgentActivityRecord {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "AzureSearchQuery" | "ModelQueryPlanning" | "AzureSearchSemanticRanker";
  /** The ID of the activity record. */
  id: number;
}

/** Base type for references. */
export interface KnowledgeAgentReference {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "AzureSearchDoc";
  /** The ID of the reference. */
  id: string;
  /** The source activity ID for the reference. */
  activitySource: number;
}

/** Common error response for all Azure Resource Manager APIs to return error details for failed operations. (This also follows the OData error response format.). */
export interface ErrorResponse {
  /** The error object. */
  error?: ErrorDetail;
}

/** The error detail. */
export interface ErrorDetail {
  /**
   * The error code.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly code?: string;
  /**
   * The error message.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly message?: string;
  /**
   * The error target.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly target?: string;
  /**
   * The error details.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly details?: ErrorDetail[];
  /**
   * The error additional info.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly additionalInfo?: ErrorAdditionalInfo[];
}

/** The resource management error additional info. */
export interface ErrorAdditionalInfo {
  /**
   * The additional info type.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly type?: string;
  /**
   * The additional info.
   * NOTE: This property will not be serialized. It can only be populated by the server.
   */
  readonly info?: Record<string, unknown>;
}

export interface KnowledgeAgentMessageImageContentImage {
  /** The url of the image. */
  url: string;
}

/** The query details for the retrieval activity. */
export interface KnowledgeAgentSearchActivityRecordQuery {
  /** The search string. */
  search?: string;
  /** The filter string. */
  filter?: string;
}

/** Text message type. */
export interface KnowledgeAgentMessageTextContent
  extends KnowledgeAgentMessageContent {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "text";
  text: string;
}

/** Text message type. */
export interface KnowledgeAgentMessageImageContent
  extends KnowledgeAgentMessageContent {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "image";
  image: KnowledgeAgentMessageImageContentImage;
}

/** Represents a retrieval activity record. */
export interface KnowledgeAgentSearchActivityRecord
  extends KnowledgeAgentActivityRecord {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "AzureSearchQuery";
  /** The target index for the retrieval activity. */
  targetIndex?: string;
  /** The query details for the retrieval activity. */
  query?: KnowledgeAgentSearchActivityRecordQuery;
  /** The query time for this retrieval activity. */
  queryTime?: Date;
  /** The count of documents retrieved. */
  count?: number;
  /** The elapsed time in milliseconds for the retrieval activity. */
  elapsedMs?: number;
}

/** Represents an LLM query planning activity record. */
export interface KnowledgeAgentModelQueryPlanningActivityRecord
  extends KnowledgeAgentActivityRecord {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "ModelQueryPlanning";
  /** The number of input tokens for the LLM query planning activity. */
  inputTokens?: number;
  /** The number of output tokens for the LLM query planning activity. */
  outputTokens?: number;
  /** The elapsed time in milliseconds for the model activity. */
  elapsedMs?: number;
}

/** Represents a semantic ranker activity record. */
export interface KnowledgeAgentSemanticRankerActivityRecord
  extends KnowledgeAgentActivityRecord {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "AzureSearchSemanticRanker";
  /** The number of input tokens for the semantic ranker activity. */
  inputTokens?: number;
  /** The elapsed time in milliseconds for the model activity. */
  elapsedMs?: number;
}

/** Represents an Azure Search document reference. */
export interface KnowledgeAgentAzureSearchDocReference
  extends KnowledgeAgentReference {
  /** Polymorphic discriminator, which specifies the different types this object can be */
  type: "AzureSearchDoc";
  /** The document key for the reference. */
  docKey?: string;
  /** Dictionary of <any> */
  sourceData?: { [propertyName: string]: any };
}

/** Known values of {@link ApiVersion20250501Preview} that the service accepts. */
export enum KnownApiVersion20250501Preview {
  /** Api Version '2025-05-01-preview' */
  TwoThousandTwentyFive0501Preview = "2025-05-01-preview",
}

/**
 * Defines values for ApiVersion20250501Preview. \
 * {@link KnownApiVersion20250501Preview} can be used interchangeably with ApiVersion20250501Preview,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **2025-05-01-preview**: Api Version '2025-05-01-preview'
 */
export type ApiVersion20250501Preview = string;

/** Known values of {@link KnowledgeAgentMessageContentType} that the service accepts. */
export enum KnownKnowledgeAgentMessageContentType {
  /** Text message content kind. */
  Text = "text",
  /** Image message content kind. */
  Image = "image",
}

/**
 * Defines values for KnowledgeAgentMessageContentType. \
 * {@link KnownKnowledgeAgentMessageContentType} can be used interchangeably with KnowledgeAgentMessageContentType,
 *  this enum contains the known values that the service supports.
 * ### Known values supported by the service
 * **text**: Text message content kind. \
 * **image**: Image message content kind.
 */
export type KnowledgeAgentMessageContentType = string;

/** Optional parameters. */
export interface KnowledgeRetrievalRetrieveOptionalParams
  extends coreClient.OperationOptions {
  /** Token identifying the user for which the query is being executed. This token is used to enforce security restrictions on documents. */
  xMsQuerySourceAuthorization?: string;
}

/** Contains response data for the retrieve operation. */
export type KnowledgeRetrievalRetrieveResponse =
  KnowledgeAgentRetrievalResponse;

/** Optional parameters. */
export interface SearchClientOptionalParams
  extends coreHttpCompat.ExtendedServiceClientOptions {
  /** Overrides client endpoint. */
  endpoint?: string;
}
