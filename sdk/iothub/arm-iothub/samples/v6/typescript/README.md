# client library samples for TypeScript

These sample programs show how to use the TypeScript client libraries for in some common scenarios.

| **File Name**                                                                               | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [certificatesCreateOrUpdate.ts][certificatescreateorupdate]                                 | Adds new or replaces existing certificate. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_certificatescreateorupdate.json                                                                                                                                                                                                                                                                                                                                   |
| [certificatesDelete.ts][certificatesdelete]                                                 | Deletes an existing X509 certificate or does nothing if it does not exist. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_certificatesdelete.json                                                                                                                                                                                                                                                                                                           |
| [certificatesGenerateVerificationCode.ts][certificatesgenerateverificationcode]             | Generates verification code for proof of possession flow. The verification code will be used to generate a leaf certificate. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_generateverificationcode.json                                                                                                                                                                                                                                                   |
| [certificatesGet.ts][certificatesget]                                                       | Returns the certificate. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_getcertificate.json                                                                                                                                                                                                                                                                                                                                                                 |
| [certificatesListByIotHub.ts][certificateslistbyiothub]                                     | Returns the list of certificates. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_listcertificates.json                                                                                                                                                                                                                                                                                                                                                      |
| [certificatesVerify.ts][certificatesverify]                                                 | Verifies the certificate's private key possession by providing the leaf cert issued by the verifying pre uploaded certificate. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_certverify.json                                                                                                                                                                                                                                                               |
| [iotHubManualFailover.ts][iothubmanualfailover]                                             | Manually initiate a failover for the IoT Hub to its secondary region. To learn more, see https://aka.ms/manualfailover x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/IotHub_ManualFailover.json                                                                                                                                                                                                                                                                   |
| [iotHubResourceCheckNameAvailability.ts][iothubresourcechecknameavailability]               | Check if an IoT hub name is available. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/checkNameAvailability.json                                                                                                                                                                                                                                                                                                                                                   |
| [iotHubResourceCreateEventHubConsumerGroup.ts][iothubresourcecreateeventhubconsumergroup]   | Add a consumer group to an Event Hub-compatible endpoint in an IoT hub. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_createconsumergroup.json                                                                                                                                                                                                                                                                                                             |
| [iotHubResourceCreateOrUpdate.ts][iothubresourcecreateorupdate]                             | Create or update the metadata of an Iot hub. The usual pattern to modify a property is to retrieve the IoT hub metadata and security metadata, and then combine them with the modified values in a new body to update the IoT hub. If certain properties are missing in the JSON, updating IoT Hub may cause these values to fallback to default, which may lead to unexpected behavior. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_createOrUpdate.json |
| [iotHubResourceDelete.ts][iothubresourcedelete]                                             | Delete an IoT hub. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_delete.json                                                                                                                                                                                                                                                                                                                                                                               |
| [iotHubResourceDeleteEventHubConsumerGroup.ts][iothubresourcedeleteeventhubconsumergroup]   | Delete a consumer group from an Event Hub-compatible endpoint in an IoT hub. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_deleteconsumergroup.json                                                                                                                                                                                                                                                                                                        |
| [iotHubResourceExportDevices.ts][iothubresourceexportdevices]                               | Exports all the device identities in the IoT hub identity registry to an Azure Storage blob container. For more information, see: https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-identity-registry#import-and-export-device-identities. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_exportdevices.json                                                                                                                                        |
| [iotHubResourceGet.ts][iothubresourceget]                                                   | Get the non-security related metadata of an IoT hub. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_get.json                                                                                                                                                                                                                                                                                                                                                |
| [iotHubResourceGetEndpointHealth.ts][iothubresourcegetendpointhealth]                       | Get the health for routing endpoints. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_routingendpointhealth.json                                                                                                                                                                                                                                                                                                                                             |
| [iotHubResourceGetJob.ts][iothubresourcegetjob]                                             | Get the details of a job from an IoT hub. For more information, see: https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-identity-registry. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_getjob.json                                                                                                                                                                                                                                                |
| [iotHubResourceGetKeysForKeyName.ts][iothubresourcegetkeysforkeyname]                       | Get a shared access policy by name from an IoT hub. For more information, see: https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-security. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_getkey.json                                                                                                                                                                                                                                               |
| [iotHubResourceGetQuotaMetrics.ts][iothubresourcegetquotametrics]                           | Get the quota metrics for an IoT hub. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_quotametrics.json                                                                                                                                                                                                                                                                                                                                                      |
| [iotHubResourceGetStats.ts][iothubresourcegetstats]                                         | Get the statistics from an IoT hub. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_stats.json                                                                                                                                                                                                                                                                                                                                                               |
| [iotHubResourceGetValidSkus.ts][iothubresourcegetvalidskus]                                 | Get the list of valid SKUs for an IoT hub. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_getskus.json                                                                                                                                                                                                                                                                                                                                                      |
| [iotHubResourceImportDevices.ts][iothubresourceimportdevices]                               | Import, update, or delete device identities in the IoT hub identity registry from a blob. For more information, see: https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-identity-registry#import-and-export-device-identities. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_importdevices.json                                                                                                                                                     |
| [iotHubResourceListByResourceGroup.ts][iothubresourcelistbyresourcegroup]                   | Get all the IoT hubs in a resource group. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_listbyrg.json                                                                                                                                                                                                                                                                                                                                                      |
| [iotHubResourceListBySubscription.ts][iothubresourcelistbysubscription]                     | Get all the IoT hubs in a subscription. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_listbysubscription.json                                                                                                                                                                                                                                                                                                                                              |
| [iotHubResourceListEventHubConsumerGroups.ts][iothubresourcelisteventhubconsumergroups]     | Get a consumer group from the Event Hub-compatible device-to-cloud endpoint for an IoT hub. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_getconsumergroup.json                                                                                                                                                                                                                                                                                            |
| [iotHubResourceListJobs.ts][iothubresourcelistjobs]                                         | Get a list of all the jobs in an IoT hub. For more information, see: https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-identity-registry. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_listjobs.json                                                                                                                                                                                                                                              |
| [iotHubResourceListKeys.ts][iothubresourcelistkeys]                                         | Get the security metadata for an IoT hub. For more information, see: https://docs.microsoft.com/azure/iot-hub/iot-hub-devguide-security. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_listkeys.json                                                                                                                                                                                                                                                       |
| [iotHubResourceTestAllRoutes.ts][iothubresourcetestallroutes]                               | Test all routes configured in this Iot Hub x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_testallroutes.json                                                                                                                                                                                                                                                                                                                                                |
| [iotHubResourceTestRoute.ts][iothubresourcetestroute]                                       | Test the new route for this Iot Hub x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_testnewroute.json                                                                                                                                                                                                                                                                                                                                                        |
| [iotHubResourceUpdate.ts][iothubresourceupdate]                                             | Update an existing IoT Hub tags. to update other fields use the CreateOrUpdate method x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_patch.json                                                                                                                                                                                                                                                                                                             |
| [operationsList.ts][operationslist]                                                         | Lists all of the available IoT Hub REST API operations. x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_operations.json                                                                                                                                                                                                                                                                                                                                      |
| [privateEndpointConnectionDelete.ts][privateendpointconnectiondelete]                       | Delete private endpoint connection with the specified name x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_deleteprivateendpointconnection.json                                                                                                                                                                                                                                                                                                              |
| [privateEndpointConnectionGet.ts][privateendpointconnectionget]                             | Get private endpoint connection properties x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_getprivateendpointconnection.json                                                                                                                                                                                                                                                                                                                                 |
| [privateEndpointConnectionUpdate.ts][privateendpointconnectionupdate]                       | Update the status of a private endpoint connection with the specified name x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_updateprivateendpointconnection.json                                                                                                                                                                                                                                                                                              |
| [privateEndpointConnectionsList.ts][privateendpointconnectionslist]                         | List private endpoint connection properties x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_listprivateendpointconnections.json                                                                                                                                                                                                                                                                                                                              |
| [privateLinkResourcesList.ts][privatelinkresourceslist]                                     | Get the specified private link resource for the given IotHub x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_getprivatelinkresources.json                                                                                                                                                                                                                                                                                                                    |
| [resourceProviderCommonGetSubscriptionQuota.ts][resourceprovidercommongetsubscriptionquota] | Get the number of free and paid iot hubs in the subscription x-ms-original-file: specification/iothub/resource-manager/Microsoft.Devices/stable/2021-07-02/examples/iothub_usages.json                                                                                                                                                                                                                                                                                                                                     |

## Prerequisites

The sample programs are compatible with [LTS versions of Node.js](https://nodejs.org/about/releases/).

Before running the samples in Node, they must be compiled to JavaScript using the TypeScript compiler. For more information on TypeScript, see the [TypeScript documentation][typescript]. Install the TypeScript compiler using:

```bash
npm install -g typescript
```

You need [an Azure subscription][freesub] to run these sample programs.

Samples retrieve credentials to access the service endpoint from environment variables. Alternatively, edit the source code to include the appropriate credentials. See each individual sample for details on which environment variables/credentials it requires to function.

Adapting the samples to run in the browser may require some additional consideration. For details, please see the [package README][package].

## Setup

To run the samples using the published version of the package:

1. Install the dependencies using `npm`:

```bash
npm install
```

2. Compile the samples:

```bash
npm run build
```

3. Edit the file `sample.env`, adding the correct credentials to access the Azure service and run the samples. Then rename the file from `sample.env` to just `.env`. The sample programs will read this file automatically.

4. Run whichever samples you like (note that some samples may require additional setup, see the table above):

```bash
node dist/certificatesCreateOrUpdate.js
```

Alternatively, run a single sample with the correct environment variables set (setting up the `.env` file is not required if you do this), for example (cross-platform):

```bash
npx cross-env  node dist/certificatesCreateOrUpdate.js
```

## Next Steps

Take a look at our [API Documentation][apiref] for more information about the APIs that are available in the clients.

[certificatescreateorupdate]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/certificatesCreateOrUpdate.ts
[certificatesdelete]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/certificatesDelete.ts
[certificatesgenerateverificationcode]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/certificatesGenerateVerificationCode.ts
[certificatesget]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/certificatesGet.ts
[certificateslistbyiothub]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/certificatesListByIotHub.ts
[certificatesverify]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/certificatesVerify.ts
[iothubmanualfailover]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubManualFailover.ts
[iothubresourcechecknameavailability]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceCheckNameAvailability.ts
[iothubresourcecreateeventhubconsumergroup]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceCreateEventHubConsumerGroup.ts
[iothubresourcecreateorupdate]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceCreateOrUpdate.ts
[iothubresourcedelete]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceDelete.ts
[iothubresourcedeleteeventhubconsumergroup]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceDeleteEventHubConsumerGroup.ts
[iothubresourceexportdevices]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceExportDevices.ts
[iothubresourceget]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceGet.ts
[iothubresourcegetendpointhealth]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceGetEndpointHealth.ts
[iothubresourcegetjob]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceGetJob.ts
[iothubresourcegetkeysforkeyname]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceGetKeysForKeyName.ts
[iothubresourcegetquotametrics]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceGetQuotaMetrics.ts
[iothubresourcegetstats]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceGetStats.ts
[iothubresourcegetvalidskus]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceGetValidSkus.ts
[iothubresourceimportdevices]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceImportDevices.ts
[iothubresourcelistbyresourcegroup]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceListByResourceGroup.ts
[iothubresourcelistbysubscription]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceListBySubscription.ts
[iothubresourcelisteventhubconsumergroups]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceListEventHubConsumerGroups.ts
[iothubresourcelistjobs]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceListJobs.ts
[iothubresourcelistkeys]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceListKeys.ts
[iothubresourcetestallroutes]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceTestAllRoutes.ts
[iothubresourcetestroute]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceTestRoute.ts
[iothubresourceupdate]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/iotHubResourceUpdate.ts
[operationslist]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/operationsList.ts
[privateendpointconnectiondelete]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/privateEndpointConnectionDelete.ts
[privateendpointconnectionget]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/privateEndpointConnectionGet.ts
[privateendpointconnectionupdate]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/privateEndpointConnectionUpdate.ts
[privateendpointconnectionslist]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/privateEndpointConnectionsList.ts
[privatelinkresourceslist]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/privateLinkResourcesList.ts
[resourceprovidercommongetsubscriptionquota]: https://github.com/Azure/azure-sdk-for-js/blob/main/sdk/iothub/arm-iothub/samples/v6/typescript/src/resourceProviderCommonGetSubscriptionQuota.ts
[apiref]: https://docs.microsoft.com/javascript/api/@azure/arm-iothub?view=azure-node-preview
[freesub]: https://azure.microsoft.com/free/
[package]: https://github.com/Azure/azure-sdk-for-js/tree/main/sdk/iothub/arm-iothub/README.md
[typescript]: https://www.typescriptlang.org/docs/home.html
