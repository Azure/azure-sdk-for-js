<!-- This sample is replicated after sendMessages.js in Javascript samples.  
Refer to other such samples and replace code in main() to try them out -->

<script src="../browser/service-bus.js"></script>
<script>
  const SBC = Azure.Messaging.ServiceBus.ServiceBusClient;

  const connectionString = "";
  const queueName = "";

  const listOfScientists = [
    { name: "Einstein", firstName: "Albert" },
    { name: "Heisenberg", firstName: "Werner" },
    { name: "Curie", firstName: "Marie" },
    { name: "Hawking", firstName: "Steven" },
    { name: "Newton", firstName: "Isaac" },
    { name: "Bohr", firstName: "Niels" },
    { name: "Faraday", firstName: "Michael" },
    { name: "Galilei", firstName: "Galileo" },
    { name: "Kepler", firstName: "Johannes" },
    { name: "Kopernikus", firstName: "Nikolaus" }
  ];

  async function main() {
    const ns = SBC.createFromConnectionString(connectionString);

    // If sending to a Topic, use `createTopicClient` instead of `createQueueClient`
    const client = ns.createQueueClient(queueName);
    const sender = client.createSender();

    try {
      for (let index = 0; index < listOfScientists.length; index++) {
        const scientist = listOfScientists[index];
        const message = {
          body: `${scientist.firstName} ${scientist.name}`,
          label: "Scientist"
        };

        console.log(`Sending message: ${message.body} - ${message.label}`);
        await sender.send(message);
      }

      await client.close();
    } finally {
      await ns.close();
    }
  }

  main().catch((err) => {
    console.log("Error occurred: ", err);
  });
</script>
